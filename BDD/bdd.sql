-- MySQL Script generated by MySQL Workbench
-- 04/25/17 12:35:14
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Utilisateur`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Utilisateur` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Nom` VARCHAR(45) NOT NULL,
  `Prenom` VARCHAR(45) NOT NULL,
  `Age` INT UNSIGNED NOT NULL,
  `Type` VARCHAR(45) NOT NULL,
  `NomConnection` VARCHAR(32) NOT NULL,
  `MotDePasse` VARCHAR(32) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `NomConnection_UNIQUE` (`NomConnection` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Eleves`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Eleves` (
  `id_utilisateur` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Numero_eleve` INT UNSIGNED NOT NULL,
  `Annee` INT UNSIGNED NOT NULL,
  `Specialite` VARCHAR(45) NULL,
  UNIQUE INDEX `id_utilisateur_UNIQUE` (`id_utilisateur` ASC),
  UNIQUE INDEX `Numero eleve_UNIQUE` (`Numero_eleve` ASC),
  PRIMARY KEY (`id_utilisateur`),
  CONSTRAINT `Eleves_idUtil`
    FOREIGN KEY (`id_utilisateur`)
    REFERENCES `mydb`.`Utilisateur` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Grille_de_competence_APP`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Grille_de_competence_APP` (
  `id_grille` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Nom_grille` VARCHAR(45) NOT NULL,
  `Annee` VARCHAR(4) NOT NULL,
  `Date` INT NOT NULL,
  PRIMARY KEY (`id_grille`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Groupe`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Groupe` (
  `id_groupe` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Nom` VARCHAR(45) NOT NULL,
  `idClient` INT UNSIGNED NULL,
  `idTuteur` INT UNSIGNED NULL,
  PRIMARY KEY (`id_groupe`),
  INDEX `Groupe_prof_idx` (`idClient` ASC),
  INDEX `Groupe_tuteur_idx` (`idTuteur` ASC),
  CONSTRAINT `Groupe_client`
    FOREIGN KEY (`idClient`)
    REFERENCES `mydb`.`Utilisateur` (`id`)
    ON DELETE SET NULL
    ON UPDATE CASCADE,
  CONSTRAINT `Groupe_tuteur`
    FOREIGN KEY (`idTuteur`)
    REFERENCES `mydb`.`Utilisateur` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Planning`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Planning` (
  `id_planning` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Nom_planning` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_planning`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Competence_principale`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Competence_principale` (
  `id_comp` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Nom_competence_principale` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_comp`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Competence_secondaire`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Competence_secondaire` (
  `id_comp_second` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `id_comp_princ` INT UNSIGNED NOT NULL,
  `Ponderation` DECIMAL(2,2) NOT NULL,
  `Nom` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_comp_second`),
  CONSTRAINT `CompSec_compPrinc`
    FOREIGN KEY (`id_comp_princ`)
    REFERENCES `mydb`.`Competence_principale` (`id_comp`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Critere`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Critere` (
  `id_critere` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `Descriptif` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_critere`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Appartient`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Appartient` (
  `idEleve` INT UNSIGNED NOT NULL,
  `idGroupe` INT UNSIGNED NOT NULL,
  INDEX `Appartient_Eleves_idx` (`idEleve` ASC),
  INDEX `Appartient_Groupe_idx` (`idGroupe` ASC),
  CONSTRAINT `Appartient_Eleves`
    FOREIGN KEY (`idEleve`)
    REFERENCES `mydb`.`Eleves` (`id_utilisateur`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Appartient_Groupe`
    FOREIGN KEY (`idGroupe`)
    REFERENCES `mydb`.`Groupe` (`id_groupe`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Evalue`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Evalue` (
  `idEleve` INT UNSIGNED NOT NULL,
  `idGroupe` INT UNSIGNED NOT NULL,
  `idComp_Sec_Util` INT UNSIGNED NOT NULL,
  `Evaluation` VARCHAR(45) NOT NULL,
  `CommentaireIndividuel` TEXT(1000) NOT NULL,
  `CommentaireGroupe` TEXT(1000) NOT NULL,
  `CommentaireProfesseur` TEXT(1000) NOT NULL,
  INDEX `Evalue_Eleve_idx` (`idEleve` ASC),
  INDEX `Evalue_Groupe_idx` (`idGroupe` ASC),
  INDEX `Evalue_CompSecUtil_idx` (`idComp_Sec_Util` ASC),
  CONSTRAINT `Evalue_Eleve`
    FOREIGN KEY (`idEleve`)
    REFERENCES `mydb`.`Eleves` (`id_utilisateur`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Evalue_Groupe`
    FOREIGN KEY (`idGroupe`)
    REFERENCES `mydb`.`Groupe` (`id_groupe`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Evalue_CompSecUtil`
    FOREIGN KEY (`idComp_Sec_Util`)
    REFERENCES `mydb`.`Competence_secondaire` (`id_comp_princ`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Consulte`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Consulte` (
  `Evaluation` VARCHAR(45) NOT NULL,
  `CommentaireGroupe` TEXT(1000) NOT NULL,
  `CommentaireIndividuel` TEXT(1000) NOT NULL,
  `idEleve` INT UNSIGNED NOT NULL,
  `idCom_Sec_Util` INT UNSIGNED NOT NULL,
  INDEX `Consulte_Eleve_idx` (`idEleve` ASC),
  INDEX `Consulte_CompSecUtil_idx` (`idCom_Sec_Util` ASC),
  CONSTRAINT `Consulte_Eleve`
    FOREIGN KEY (`idEleve`)
    REFERENCES `mydb`.`Eleves` (`id_utilisateur`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Consulte_CompSecUtil`
    FOREIGN KEY (`idCom_Sec_Util`)
    REFERENCES `mydb`.`Competence_secondaire` (`id_comp_princ`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Lie2`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Lie2` (
  `idEleve` INT UNSIGNED NOT NULL,
  `idGrilleComp` INT UNSIGNED NOT NULL,
  INDEX `Lie2_Eleve_idx` (`idEleve` ASC),
  INDEX `Lie2_GrilleComp_idx` (`idGrilleComp` ASC),
  CONSTRAINT `Lie2_Eleve`
    FOREIGN KEY (`idEleve`)
    REFERENCES `mydb`.`Eleves` (`id_utilisateur`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Lie2_GrilleComp`
    FOREIGN KEY (`idGrilleComp`)
    REFERENCES `mydb`.`Grille_de_competence_APP` (`id_grille`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Lie3`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Lie3` (
  `idGrilleComp` INT UNSIGNED NOT NULL,
  `idCompPrin` INT UNSIGNED NOT NULL,
  INDEX `Lie3_GrilleComp_idx` (`idGrilleComp` ASC),
  INDEX `Lie3_CompPrin_idx` (`idCompPrin` ASC),
  CONSTRAINT `Lie3_GrilleComp`
    FOREIGN KEY (`idGrilleComp`)
    REFERENCES `mydb`.`Grille_de_competence_APP` (`id_grille`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Lie3_CompPrin`
    FOREIGN KEY (`idCompPrin`)
    REFERENCES `mydb`.`Competence_principale` (`id_comp`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Lie5`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Lie5` (
  `idCompSecUtil` INT UNSIGNED NOT NULL,
  `idCritere` INT UNSIGNED NOT NULL,
  INDEX `Lie5_CompSecUtil_idx` (`idCompSecUtil` ASC),
  INDEX `Lie5_Critere_idx` (`idCritere` ASC),
  CONSTRAINT `Lie5_CompSecUtil`
    FOREIGN KEY (`idCompSecUtil`)
    REFERENCES `mydb`.`Competence_secondaire` (`id_comp_princ`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Lie5_Critere`
    FOREIGN KEY (`idCritere`)
    REFERENCES `mydb`.`Critere` (`id_critere`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Lie6`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Lie6` (
  `idGroupe` INT UNSIGNED NOT NULL,
  `idPlaning` INT UNSIGNED NOT NULL,
  `Descriptif` TEXT(1000) NOT NULL,
  `Date` DATE NOT NULL,
  `Heure` TIME NULL,
  INDEX `Lie6_Groupe_idx` (`idGroupe` ASC),
  INDEX `Lie6_Planning_idx` (`idPlaning` ASC),
  CONSTRAINT `Lie6_Groupe`
    FOREIGN KEY (`idGroupe`)
    REFERENCES `mydb`.`Groupe` (`id_groupe`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `Lie6_Planning`
    FOREIGN KEY (`idPlaning`)
    REFERENCES `mydb`.`Planning` (`id_planning`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
